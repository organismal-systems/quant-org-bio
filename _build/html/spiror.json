{"version":3,"kind":"Notebook","sha256":"f3261c180ca6ec4762f7000b264accbc56f38ced30660ea84279a5440023ccdb","slug":"spiror","location":"/subrepos/demography/Spirorbis/Spiror.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Daniel Grünbaum","given":"Daniel","family":"Grünbaum"},"name":"Daniel Grünbaum","affiliations":["School of Oceanography, University of Washington"],"id":"contributors-myst-generated-uid-0"}],"license":{"content":{"id":"CC-BY-NC-SA-4.0","url":"https://creativecommons.org/licenses/by-nc-sa/4.0/","name":"Creative Commons Attribution Non Commercial Share Alike 4.0 International","CC":true}},"github":"https://github.com/organismal-systems/quant-org-bio","keywords":["models"],"copyright":"2025","affiliations":[{"id":"School of Oceanography, University of Washington","name":"School of Oceanography, University of Washington"}],"numbering":{"title":{"offset":2}},"source_url":"https://github.com/organismal-systems/quant-org-bio/blob/main/subrepos/demography/Spirorbis/Spiror.ipynb","edit_url":"https://github.com/organismal-systems/quant-org-bio/edit/main/subrepos/demography/Spirorbis/Spiror.ipynb","exports":[{"format":"ipynb","filename":"Spiror.ipynb","url":"/build/Spiror-4f44c231f2febd7eeb654f7f673a891f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A multi-habitat, multi-strain model of Spirobis population dynamics.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCCdxJO1sk"}],"key":"MiTl0coXIt"}],"key":"hq0HI3U0S3"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import pyplot as plt\nplt.ion();\nfrom ipywidgets import interact, interactive, fixed, interact_manual\nimport ipywidgets as widgets\nfrom spiror import SpirorbisStrain,Site,SimParams,SimSites","visibility":"show","key":"WbY6ZWLncO"},{"type":"outputs","id":"1MwUcQHClf_Jdge9Wku9b","children":[],"visibility":"show","key":"JuF61oW1NL"}],"visibility":"show","key":"hnDktWuVLV"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true}},"children":[{"type":"code","lang":"python","executable":true,"value":"global glob_site,glob_strain,glob_sim\nglobal glob_strains, glob_sites\nglob_strains = [] # Placeholder for a list of strains\nglob_sites = []   # Placeholder for a list of sites\nglobal sim_pars","key":"LyYNGHUnFD"},{"type":"outputs","id":"LD6_vPbhSeSxTfD0Y8v1C","children":[],"key":"SECrJ6Ubip"}],"key":"Z9tEI2Pvv0"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Generate strains\n# Instantiate one or more SpirorbisStrain objects and create a GUI to modify parameters. \nlbl = widgets.Text(value='strain',width=10,description = r\"label\")\nclr = widgets.Text(value='k',width=10,description = r\"color\")\nfcnd = widgets.FloatText(value=10**4,description = r\"fecundity, $f$\")\nslct_fucus = widgets.FloatText(value=1.,width=10,description = r\"Fucus select.\")\nslct_asco = widgets.FloatText(value=1.,width=10,description = r\"Asco select\")\ninit_larv=widgets.FloatText(value=10**8,description = r\"Initial larvae\")\ninit_fucus=widgets.FloatText(value=0.,description = r\"Initial Fucus\")\ninit_asco=widgets.FloatText(value=0.,description = r\"Initial Asco\")\n\nui1 = widgets.VBox([lbl,init_fucus,slct_fucus])\nui2 = widgets.VBox([clr,init_asco,slct_asco])\nui3 = widgets.VBox([fcnd,init_larv])\nui4 = widgets.HBox([ui1,ui2,ui3])\n\ndef set_strain_pars(lbl_,clr_,fcnd_,slct_fucus_,slct_asco_,init_larv_,init_fucus_,init_asco_):\n    global glob_strain\n    glob_strain = SpirorbisStrain(label=lbl_,color=clr_,fecundity=fcnd_,select_fucus=slct_fucus_,\n                                  select_asco=slct_asco_,initial_larvae=init_larv_,\n                                  initial_adults_fucus=init_fucus_,initial_adults_asco=init_asco_)\n    \nout = widgets.interactive_output(set_strain_pars,{'lbl_':lbl,'clr_':clr,'fcnd_':fcnd,\n                                            'slct_fucus_':slct_fucus,'slct_asco_':slct_asco,\n                                            'init_larv_':init_larv,'init_fucus_':init_fucus,\n                                            'init_asco_':init_asco})\ndisplay(ui4,out)\n\nbutton1 = widgets.Button(description=\"Add strain to list\")\noutput1 = widgets.Output()\n\nbuttonsL1 = widgets.HBox([button1, output1])\ndisplay(buttonsL1)\n\n@output1.capture()\ndef on_button_clicked1(b):\n    global glob_strain,glob_strains\n    glob_strains.append(glob_strain)\n\nbutton1.on_click(on_button_clicked1)\n\nbutton3 = widgets.Button(description=\"Show strain list\")\noutput3 = widgets.Output()\n\nbuttonsL3 = widgets.HBox([button3, output3])\ndisplay(buttonsL3)\n\n@output3.capture()\ndef on_button_clicked3(b):\n    global glob_strains\n    output3.clear_output()\n    if len(glob_strains) == 0:\n        print('\\n\\nStrain list is empty...')\n    else:\n        for i,strain in enumerate(glob_strains):\n            print(f'\\n\\nStrain {i}:')\n            print(f'\\tlabel = {strain.label}')\n            print(f'\\tcolor = {strain.color}')\n            print(f'\\tfecundity = {strain.fecundity:.2e}')\n            print(f'\\tFucus selectivity = {strain.select_fucus}')\n            print(f'\\tAscophyllum selectivity = {strain.select_asco}')\n            print(f'\\tInitial number of larvae = {strain.initial_larvae:.2e}')\n            print(f'\\tInitial adults on Fucus = {strain.initial_adults_fucus:.2e}')\n            print(f'\\tInitial adults on Ascophyllum = {strain.initial_adults_asco:.2e}')\n        \n\nbutton3.on_click(on_button_clicked3)","key":"Gd5SkLp0LS"},{"type":"outputs","id":"6-0T9EtOIm6po52gKEky7","children":[],"key":"fORlUXwYgp"}],"key":"bNOSuoCzTR"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true}},"children":[{"type":"code","lang":"python","executable":true,"value":"button2 = widgets.Button(description=\"Reset strain list\")\noutput2 = widgets.Output()\n\nbuttonsL2 = widgets.HBox([button2, output2])\ndisplay(buttonsL2)\n\n@output2.capture()\ndef on_button_clicked2(b):\n    global glob_strains\n    glob_strains = []\n\nbutton2.on_click(on_button_clicked2)","key":"Pr9WNWeBCQ"},{"type":"outputs","id":"7y82W5Uvel1GPsYY5A-vQ","children":[],"key":"A7Kdnou35p"}],"key":"xH9kndzMMZ"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Generate sites\n# Instantiate one or more Site objects and create a GUI to modify parameters. \nlbl2 = widgets.Text(value='site',width=10,description = r\"label\")\ncarry_cap = widgets.FloatText(value=10**4,description = r\"Carrying Cap.\")\nmort_fucus = widgets.FloatText(value=0.1,width=10,description = r\"Mort. on Fucus\")\nmort_asco = widgets.FloatText(value=0.5,width=10,description = r\"Mort. on Asco\")\nmort_larv = widgets.FloatText(value=0.1,width=10,description = r\"Mort. of Larvae\")\nfrac_fucus=widgets.FloatText(value=0.5,description = r\"Fraction Fucus\")\ncat_prob=widgets.FloatText(value=0.,description = r\"Catast. Prob.\")\nenc_prob=widgets.FloatText(value=0.0001,description = r\"Encount. Prob.\")\n\nui1a = widgets.VBox([lbl2,mort_fucus,enc_prob])\nui2a = widgets.VBox([carry_cap,mort_asco,cat_prob])\nui3a = widgets.VBox([frac_fucus,mort_larv])\nui4a = widgets.HBox([ui1a,ui2a,ui3a])\n\n\n#site1 = Site(mortality_larvae = 0.1,mortality_fucus = 0.1,mortality_asco = 0.5,\n#                 carrying_cap = 10**5,strains=[fucus_specialist,asco_specialist,generalist],f = 0.5,cat = 0.,\n#                 encounter_prob = 0.0001,label='Tidepool (low turb.)')\n\n\ndef set_site_pars(lbl2_,carry_cap_,mort_fucus_,mort_asco_,mort_larv_,frac_fucus_,cat_prob_,enc_prob_):\n    global glob_site\n    glob_site = Site(label=lbl2_,mortality_larvae=mort_larv_,mortality_fucus=mort_fucus_,mortality_asco=mort_asco_,\n                 carrying_cap=carry_cap_,strains=glob_strains,f=frac_fucus_,cat=cat_prob_,\n                 encounter_prob=enc_prob_)\n                         \nout2 = widgets.interactive_output(set_site_pars,{'lbl2_':lbl2,'carry_cap_':carry_cap,\n                                            'mort_fucus_':mort_fucus,'mort_asco_':mort_asco,\n                                            'mort_larv_':mort_larv,'frac_fucus_':frac_fucus,\n                                            'cat_prob_':cat_prob,'enc_prob_':enc_prob})\ndisplay(ui4a,out2)\n\nbutton1a = widgets.Button(description=\"Add site to list\")\noutput1a = widgets.Output()\n\nbuttonsL2 = widgets.HBox([button1a, output1a])\ndisplay(buttonsL2)\n\n@output1a.capture()\ndef on_button_clicked1a(b):\n    global glob_site,glob_sites\n    glob_sites.append(glob_site)\n\nbutton1a.on_click(on_button_clicked1a)\n\nbutton3a = widgets.Button(description=\"Show site list\")\noutput3a = widgets.Output()\n\nbuttonsL3a = widgets.HBox([button3a, output3a])\ndisplay(buttonsL3a)\n\n@output3a.capture()\ndef on_button_clicked3a(b):\n    global glob_sites\n    output3a.clear_output()\n    if len(glob_sites) == 0:\n        print('\\n\\nSite list is empty...')\n    else:\n        for i,site in enumerate(glob_sites):\n            print(f'\\n\\nSite {i}:')\n            print(f'\\tlabel = {site.label}')\n            print(f'\\tCarrying capacity = {site.carrying_cap:.2e}')\n            print(f'\\tFraction Fucus = {site.f}')\n            print(f'\\tMortality of larvae = {site.mortality_larvae:.2e}')\n            print(f'\\tMortality of adults on Fucus = {site.mortality_fucus:.2e}')\n            print(f'\\tMortality of adults on Ascophyllum = {site.mortality_asco:.2e}')\n            print(f'\\tProbability of catastrophe = {site.cat}')\n            print(f'\\tProbability larvae encounter substrate = {site.encounter_prob}')\n        \n\nbutton3a.on_click(on_button_clicked3a)\n#button2a = widgets.Button(description=\"Reset strain list\")\n#output2 = widgets.Output()","key":"kyu7N848Tw"},{"type":"outputs","id":"0e8DiVtEKCbgqqzEEYREh","children":[],"key":"ZIcTIre2EC"}],"key":"NYWwnJCACE"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true}},"children":[{"type":"code","lang":"python","executable":true,"value":"button2a = widgets.Button(description=\"Reset site list\")\noutput2a = widgets.Output()\n\nbuttonsL2a = widgets.HBox([button2a, output2a])\ndisplay(buttonsL2a)\n\n@output2a.capture()\ndef on_button_clicked2a(b):\n    global glob_sites\n    glob_sites = []\n\nbutton2a.on_click(on_button_clicked2a)","key":"ddJz7GIYnM"},{"type":"outputs","id":"9LWCT_hE7W3WQp1H0w61K","children":[],"key":"ARazSeIXDz"}],"key":"G5qtE7ZrHW"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Instantiate a SimParams object and create a GUI to modify parameters and run the simulation. \nexchange = widgets.FloatText(value=0.,description = r\"Exchange\")\ntimesteps = widgets.IntText(value=4*10**3,width=10,description = r\"Timesteps\")\nplt_int = widgets.IntText(value=20,width=10,description = r\"Plot Interval\")\n\nui1b = widgets.VBox([timesteps,plt_int,exchange])\n#ui2b = widgets.VBox([carry_cap,mort_asco,cat_prob])\n#ui3b = widgets.VBox([frac_fucus,mort_larv])\n#ui4b = widgets.HBox([ui1b,ui2b,ui3b])\n\ndef set_sim_pars(timesteps_,plt_int_,exchange_):\n    global sim_pars,glob_sites\n    sim_pars = SimParams(exchange=exchange_,timesteps=timesteps_,plot_interval=plt_int_,sites=glob_sites)\n    #sim = SimSites(sim_pars)\n\nout3 = widgets.interactive_output(set_sim_pars,{'timesteps_':timesteps,'plt_int_':plt_int,\n                                            'exchange_':exchange})\ndisplay(ui1b,out3)\n\nbutton1b = widgets.Button(description=\"Run simulation\")\noutput1b = widgets.Output()\n\n#sim_pars = SimParams(A_openwater = 10**5,exchange_rate = 0.2,timesteps = 4 * 10**3,\n#                     plot_interval = 20,sites=glob_sites)\n#sim = SimSites(sim_pars)\n\n\n","key":"GS37DaHiSI"},{"type":"outputs","id":"tPc1wxr8ai9POGHyT791I","children":[],"key":"qHMuESbk1k"}],"key":"s9AB1mKplX"},{"type":"block","kind":"notebook-code","data":{"jupyter":{"source_hidden":true}},"children":[{"type":"code","lang":"python","executable":true,"value":"button2b = widgets.Button(description=\"Run simulation\")\noutput2b = widgets.Output()\n\nbuttonsL2b = widgets.HBox([button2b, output2b])\ndisplay(buttonsL2b)\n\n@output2b.capture()\ndef on_button_clicked2b(b):\n    global sim_pars\n    output2b.clear_output()\n    sim = SimSites(sim_pars)\n    plt.show()\n\nbutton2b.on_click(on_button_clicked2b)","key":"vjYGpM5LFL"},{"type":"outputs","id":"Wgyk7IJCqmF1Ipre3PlCK","children":[],"key":"TYmz4qs9qu"}],"key":"JC8k07Eyyd"}],"key":"RKt6FvDjih"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Cholera4b","url":"/cholera4b","group":"Demography"},"next":{"title":"README","url":"/readme-4","group":"Spatial Dynamics"}}},"domain":"http://localhost:3002"}