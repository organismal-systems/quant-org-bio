{"version":3,"kind":"Notebook","sha256":"79807e5ff6ae21fc3f63e49dd1fb650fe93c6b47ac6d1b3c195b0aed238b63c3","slug":"estlarvswim","location":"/subrepos/spatial-dynamics/EstuaryLarva/EstLarvSwim.ipynb","dependencies":[],"frontmatter":{"title":"Larval recruitment in estuaries","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Daniel Grünbaum","given":"Daniel","family":"Grünbaum"},"name":"Daniel Grünbaum","affiliations":["School of Oceanography, University of Washington"],"id":"contributors-myst-generated-uid-0"}],"license":{"content":{"id":"CC-BY-NC-SA-4.0","url":"https://creativecommons.org/licenses/by-nc-sa/4.0/","name":"Creative Commons Attribution Non Commercial Share Alike 4.0 International","CC":true}},"github":"https://github.com/organismal-systems/quant-org-bio","keywords":["models"],"copyright":"2025","affiliations":[{"id":"School of Oceanography, University of Washington","name":"School of Oceanography, University of Washington"}],"numbering":{"title":{"offset":2}},"source_url":"https://github.com/organismal-systems/quant-org-bio/blob/main/subrepos/spatial-dynamics/EstuaryLarva/EstLarvSwim.ipynb","edit_url":"https://github.com/organismal-systems/quant-org-bio/edit/main/subrepos/spatial-dynamics/EstuaryLarva/EstLarvSwim.ipynb","thumbnail":"/build/EL_1-2004a1f6ec1c5dabb4ff5468f0a03e52.png","exports":[{"format":"ipynb","filename":"EstLarvSwim.ipynb","url":"/build/EstLarvSwim-f6361ddd198ef25c2ac98a57283aa9bb.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"editable":true,"jupyter":{"source_hidden":true},"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib widget\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom IPython import display\n#from os import listdir\nfrom glob import glob\nimport ipywidgets as widgets\nfrom EstLarvSwim import Estuary, Larvae, SwimSim\nplt.ioff()","visibility":"show","key":"fMgZh93tTE"},{"type":"outputs","id":"Lx6eMuIamUrfqgfZ8f6tB","children":[],"visibility":"show","key":"ZQ36AE7cDq"}],"visibility":"hide","key":"NDLHzYH2z2"},{"type":"block","kind":"notebook-code","data":{"editable":true,"jupyter":{"source_hidden":true},"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"global estuary\nestuaries = glob('Estuaries/*.out')\nout = widgets.Output()\nHTML_text_widget = widgets.HTML(value='<b>Choose an estuary/flow scenario: </b>')\nest = widgets.Select(\n    options=estuaries,\n    value=estuaries[0],\n    rows=len(estuaries),\n    description='',\n    disabled=False\n)\nestuary = Estuary(infile=est.value)  # load default estuary/flow scenario\nbuttonE = widgets.Button(\n    description='Load estuary',\n    disabled=False,\n    button_style='', # 'success', 'info', 'warning', 'danger' or ''\n    tooltip='Load estuary',\n    icon='check' # (FontAwesome names without the `fa-` prefix)\n)\n\ndef on_button_clickedE(b):\n    global estuary,est\n    estuary = Estuary(infile=est.value)\n\nbuttonE.on_click(on_button_clickedE)\n\nwidgets.Box([HTML_text_widget,\n              est,buttonE])","visibility":"show","key":"tSEh1OdhPP"},{"type":"outputs","id":"ZrtOxojrzp26BwkcnGewd","children":[],"visibility":"show","key":"JUp4fSV5l6"}],"visibility":"hide","key":"Ebc9D4pjiw"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"container","kind":"figure","children":[{"type":"_lift","align":"left","remove-input":true,"source":{"label":"el_1"},"key":"lfCX0oj72j"},{"type":"image","placeholder":true,"url":"/build/EL_1-2004a1f6ec1c5dabb4ff5468f0a03e52.png","align":"left","key":"vRdnTFIzp9","urlSource":"./Images/EL_1.png"}],"enumerator":"1","source":{"label":"el_1"},"key":"vRoynRSHKd"}],"visibility":"show","key":"GibSuq7o1q"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Define parameters for the first of three optional variants","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SjwOiRTYLC"}],"key":"xY0QGpM884"}],"visibility":"show","key":"o8BBLqzHRe"},{"type":"block","kind":"notebook-code","data":{"editable":true,"jupyter":{"source_hidden":true},"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set simulation parameters for cohort 1\nglobal L1,L1pars\nHTML_text_widgetL1 = widgets.HTML(value='<b>Characteristics of Larval Variant 1: </b>')\nstyle = {'description_width': 'initial'}\nL1pars_N=widgets.IntText(value=64,width=5,description = r\"Number, $N$\")\nL1pars_reldate=widgets.FloatText(value=60,width=5,description = r\"Release Date\")\nL1pars_sdd=widgets.Text(value='4,10',description = r\"Stage Durations (days)\",style=style)\nL1pars_sv=widgets.Text(value='-500e-6,500e-6',description = r\"Stage velocities ($\\frac{m}{s}$)\",style=style)\nL1pars_color=widgets.Text(value='blue',description = r\"Color\")\nL1pars_sis=widgets.Checkbox(value=True,description = r\"Settle in substrate\")\nL1pars_se=widgets.Text(value='-80,-40',description = r\"Substrate Extent ($km$)\")\nL1pars_reldepths=widgets.Text(value='0.1,1',width=5,description = r\"Release Depths\",style=style)\n\nL1_0s = widgets.VBox([L1pars_N,L1pars_reldate,L1pars_reldepths])\nL1_0s.layout.align_items = 'flex-end'\nL1_1s = widgets.VBox([L1pars_color,L1pars_sdd,L1pars_se])\nL1_1s.layout.align_items = 'flex-end'\nL1_2s = widgets.VBox([L1pars_sis,L1pars_sv])\nL1_2s.layout.align_items = 'flex-end'\nL1_012s = widgets.HBox([L1_0s,L1_1s,L1_2s])\n\ntoList = lambda s: eval('['+s+']')\n\ndef set_L1pars(N,reldate,sdd,sv,sis,color,se,reldepths):\n    global L1,L1_pars\n    L1 = Larvae(N=N,release_date=reldate,\n                stage_durations_days=toList(sdd),stage_velocities=toList(sv),\n              color=color,settle_in_substrate=sis,substrate_extent=toList(se),\n              release_depths=toList(reldepths))\n\nouts1 = widgets.interactive_output(set_L1pars,{'N':L1pars_N,'reldate':L1pars_reldate,'sdd':L1pars_sdd,'sv':L1pars_sv,'sis':L1pars_sis,\n                                                'color':L1pars_color,'se':L1pars_se,\n                                                'reldepths':L1pars_reldepths})\nwidgets.VBox([HTML_text_widgetL1,widgets.HBox([L1_012s,outs1])])","visibility":"show","key":"q3jVYZwwCt"},{"type":"outputs","id":"BOT0P6zXhBpYmMKoL2hPs","children":[],"visibility":"show","key":"blZu8R1rs0"}],"visibility":"hide","key":"v23LCwa9Cu"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"container","kind":"figure","children":[{"type":"_lift","align":"left","remove-input":true,"source":{"label":"el_2"},"key":"aO4BOp3hEJ"},{"type":"image","placeholder":true,"url":"/build/EL_2-c71699323d759395b749e0944d232fe2.png","align":"left","key":"kfAtA5yJ5Y","urlSource":"./Images/EL_2.png"}],"enumerator":"2","source":{"label":"el_2"},"key":"w97cNdu4Ax"}],"visibility":"show","key":"GfhdjZfOwu"},{"type":"block","kind":"notebook-code","data":{"editable":true,"jupyter":{"source_hidden":true},"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set simulation parameters for cohort 2\nglobal L2,L2pars\nHTML_text_widgetL2 = widgets.HTML(value='<b>Characteristics of Larval Variant 2: </b>')\nL2pars_N=widgets.IntText(value=64,width=5,description = r\"Number, $N$\")\nL2pars_reldate=widgets.FloatText(value=60,width=5,description = r\"Release Date\")\nL2pars_sdd=widgets.Text(value='4,10',description = r\"Stage Durations (days)\",style=style)\nL2pars_sv=widgets.Text(value='-500e-6,500e-6',description = r\"Stage velocities ($\\frac{m}{s}$)\",style=style)\nL2pars_color=widgets.Text(value='red',description = r\"Color\")\nL2pars_sis=widgets.Checkbox(value=True,description = r\"Settle in substrate\")\nL2pars_se=widgets.Text(value='-80,-40',description = r\"Substrate Extent ($km$)\")\nL2pars_reldepths=widgets.Text(value='0.1,1',width=5,description = r\"Release Depths\",style=style)\n\nL2_0s = widgets.VBox([L2pars_N,L2pars_reldate,L2pars_reldepths])\nL2_0s.layout.align_items = 'flex-end'\nL2_1s = widgets.VBox([L2pars_color,L2pars_sdd,L2pars_se])\nL2_1s.layout.align_items = 'flex-end'\nL2_2s = widgets.VBox([L2pars_sis,L2pars_sv])\nL2_2s.layout.align_items = 'flex-end'\nL2_012s = widgets.HBox([L2_0s,L2_1s,L2_2s])\n\ndef set_L2pars(N,reldate,sdd,sv,sis,color,se,reldepths):\n    global L2,L2_pars\n    L2 = Larvae(N=N,release_date=reldate,\n                stage_durations_days=toList(sdd),stage_velocities=toList(sv),\n              color=color,settle_in_substrate=sis,substrate_extent=toList(se),\n              release_depths=toList(reldepths))\n\nouts2 = widgets.interactive_output(set_L2pars,{'N':L2pars_N,'reldate':L2pars_reldate,'sdd':L2pars_sdd,'sv':L2pars_sv,'sis':L2pars_sis,\n                                                'color':L2pars_color,'se':L2pars_se,\n                                                'reldepths':L2pars_reldepths})\nwidgets.VBox([HTML_text_widgetL2,widgets.HBox([L2_012s,outs2])])","visibility":"show","key":"mmEOiqkfEd"},{"type":"outputs","id":"bhV1aJkTUJ-c4x_hYQ9t0","children":[],"visibility":"show","key":"XNZvq8mMCt"}],"visibility":"hide","key":"lzENOL7Wz3"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"container","kind":"figure","children":[{"type":"_lift","align":"left","remove-input":true,"source":{"label":"el_3"},"key":"t05OQt1miX"},{"type":"image","placeholder":true,"url":"/build/EL_3-fdb54232d973681f7f86a05ebfb34c30.png","align":"left","key":"fGWGoKKYN1","urlSource":"./Images/EL_3.png"}],"enumerator":"3","source":{"label":"el_3"},"key":"FunZnKdrZC"}],"visibility":"show","key":"R8KsdtGqyF"},{"type":"block","kind":"notebook-code","data":{"editable":true,"jupyter":{"source_hidden":true},"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set larval parameters for cohort 3\nglobal L3,L3pars\nHTML_text_widgetL3 = widgets.HTML(value='<b>Characteristics of Larval Variant 3: </b>')\nL3pars_N=widgets.IntText(value=64,width=5,description = r\"Number, $N$\")\nL3pars_reldate=widgets.FloatText(value=60,width=5,description = r\"Release Date\")\nL3pars_sdd=widgets.Text(value='4,10',description = r\"Stage Durations (days)\",style=style)\nL3pars_sv=widgets.Text(value='-500e-6,500e-6',description = r\"Stage velocities ($\\frac{m}{s}$)\",style=style)\nL3pars_color=widgets.Text(value='magenta',description = r\"Color\")\nL3pars_sis=widgets.Checkbox(value=True,description = r\"Settle in substrate\")\nL3pars_se=widgets.Text(value='-80,-40',description = r\"Substrate Extent ($km$)\")\nL3pars_reldepths=widgets.Text(value='0.1,1',width=5,description = r\"Release Depths\",style=style)\n\nL3_0s = widgets.VBox([L3pars_N,L3pars_reldate,L3pars_reldepths])\nL3_0s.layout.align_items = 'flex-end'\nL3_1s = widgets.VBox([L3pars_color,L3pars_sdd,L3pars_se])\nL3_1s.layout.align_items = 'flex-end'\nL3_2s = widgets.VBox([L3pars_sis,L3pars_sv])\nL3_2s.layout.align_items = 'flex-end'\nL3_012s = widgets.HBox([L3_0s,L3_1s,L3_2s])\n\ndef set_L3pars(N,reldate,sdd,sv,sis,color,se,reldepths):\n    global L3,L3_pars\n    L3 = Larvae(N=N,release_date=reldate,\n                stage_durations_days=toList(sdd),stage_velocities=toList(sv),\n              color=color,settle_in_substrate=sis,substrate_extent=toList(se),\n              release_depths=toList(reldepths))\n\nouts3 = widgets.interactive_output(set_L3pars,{'N':L3pars_N,'reldate':L3pars_reldate,'sdd':L3pars_sdd,'sv':L3pars_sv,'sis':L3pars_sis,\n                                                'color':L3pars_color,'se':L3pars_se,\n                                                'reldepths':L3pars_reldepths})\nwidgets.VBox([HTML_text_widgetL3,widgets.HBox([L3_012s,outs3])])","visibility":"show","key":"Uo565xBb6d"},{"type":"outputs","id":"UJAU6RQ51YgPDF6jNk0xT","children":[],"visibility":"show","key":"TqfUeutuHq"}],"visibility":"hide","key":"TLpixXT67i"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"container","kind":"figure","children":[{"type":"_lift","align":"left","remove-input":true,"source":{"label":"el_4"},"key":"T4YtIM1F8i"},{"type":"image","placeholder":true,"url":"/build/EL_4-aa1aa1f98f2f8dbf64a612508d48d75e.png","align":"left","key":"kVIjdIMFsf","urlSource":"./Images/EL_4.png"}],"enumerator":"4","source":{"label":"el_4"},"key":"LbC5fkDVoB"}],"visibility":"show","key":"kwUzLeHPvt"},{"type":"block","kind":"notebook-code","data":{"editable":true,"jupyter":{"source_hidden":true},"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# GUI to specify parameters and run simulations\nglobal S\nS = SwimSim()\n\noutS = widgets.Output()\nHTML_text_widgetS = widgets.HTML(value='<b>Choose simulation parameters: </b>')\n\nSpars_pltint=widgets.Text(value='2*3600',description = r\"Plot interval ($s$)\",style=style)\nSpars_days=widgets.Text(value='60,72',description = r\"Days to simulate\",style=style)\nSpars_L1=widgets.Checkbox(value=True,description = r\"Include variant 1\",style=style)\nSpars_L2=widgets.Checkbox(value=True,description = r\"Include variant 2\",style=style)\nSpars_L3=widgets.Checkbox(value=True,description = r\"Include variant 3\",style=style)\n\nbuttonU = widgets.ToggleButton(\n    value=False,\n    description='Update parameters',\n    disabled=False,\n    button_style='', # 'success', 'info', 'warning', 'danger' or ''\n    tooltip='Click to implement changes to estuary or larval parameters.',\n    icon='' # (FontAwesome names without the `fa-` prefix)\n)\n\nS_0s = widgets.VBox([Spars_days,Spars_pltint,buttonU])\nS_0s.layout.align_items = 'flex-end'\nS_1s = widgets.VBox([Spars_L1,Spars_L2,Spars_L3])\nS_1s.layout.align_items = 'flex-end'\nS_01s = widgets.HBox([S_0s,S_1s])\n\ndef set_Spars(days,pltint,useL1,useL2,useL3,up):\n    global S,L1,L2,L3,estuary\n    larvae = []\n    if useL1:\n        larvae.append(L1)\n    if useL2:\n        larvae.append(L2)\n    if useL3:\n        larvae.append(L3)    \n    S = SwimSim(estuary=estuary,larvae=larvae,plot_interval=eval(pltint),days=toList(days),plot_mode='ipynb')\n\nouts4 = widgets.interactive_output(set_Spars,{'days':Spars_days,'pltint':Spars_pltint,'useL1':Spars_L1,'useL2':Spars_L2,'useL3':Spars_L3,'up':buttonU})\n\nwidgets.VBox([HTML_text_widgetS,S_01s,outs4])","visibility":"show","key":"XZiiU9SdGi"},{"type":"outputs","id":"ah7m6mZU-KomL4pelit44","children":[],"visibility":"show","key":"FkQ4kb4tL9"}],"visibility":"hide","key":"CDWg66yXak"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"container","kind":"figure","children":[{"type":"_lift","align":"left","remove-input":true,"source":{"label":"el_5"},"key":"dkrfBZgjK2"},{"type":"image","placeholder":true,"url":"/build/EL_5-a49bfd3f30699de4b0982954911f95d1.png","align":"left","key":"siR9cwJb4w","urlSource":"./Images/EL_5.png"}],"enumerator":"5","source":{"label":"el_5"},"key":"ibRw6ot1Aw"}],"visibility":"show","key":"v1MhMjS5DP"},{"type":"block","kind":"notebook-code","data":{"editable":true,"jupyter":{"source_hidden":true},"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"buttonS = widgets.Button(\n    description='Run simulation',\n    disabled=False,\n    button_style='', # 'success', 'info', 'warning', 'danger' or ''\n    tooltip='Click to run simulation using current parameters.',\n    icon='' # (FontAwesome names without the `fa-` prefix)\n)\noutputS = widgets.Output()\n@outputS.capture()\ndef on_button_clickedS(b):\n    global S\n    S.halt = False\n    with plt.ioff():\n        S.run()\nbuttonS.on_click(on_button_clickedS)\nwidgets.VBox([buttonS,outputS])","visibility":"show","key":"qDkFOLrwnK"},{"type":"outputs","id":"_ALDbFUrdVprfKYniRXfP","children":[],"visibility":"show","key":"Lefnu4zAPW"}],"visibility":"hide","key":"LtAKK8T8o6"},{"type":"block","kind":"notebook-content","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"container","kind":"figure","children":[{"type":"_lift","align":"left","remove-input":true,"source":{"label":"el_6"},"key":"e3qiT6tHFK"},{"type":"image","placeholder":true,"url":"/build/EL_6-60cf957e4d83b5d6ea38ca6e4048032b.png","align":"left","key":"ovGFOF0MoZ","urlSource":"./Images/EL_6.png"}],"enumerator":"6","source":{"label":"el_6"},"key":"ERTwd07ueN"}],"visibility":"show","key":"sjCsot1VNt"},{"type":"block","kind":"notebook-code","data":{"editable":true,"jupyter":{"source_hidden":true},"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"S.halt = True","visibility":"show","key":"YP4WX1rlce"},{"type":"outputs","id":"q-_B-Pr96ztg5LTZusEJH","children":[],"visibility":"show","key":"evPxO26lhW"}],"visibility":"show","key":"OWg9kieqps"}],"key":"bRe6yhxXlu"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"README","url":"/readme-4","group":"Spatial Dynamics"},"next":{"title":"FSL","url":"/fsl","group":"Spatial Dynamics"}}},"domain":"http://localhost:3002"}